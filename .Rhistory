#calculate Ns
Ns_tmp <- Ns_calc(subset(all_families,all_families$cohort == "BMR16"))
#isolating data to plot
df <- data.frame(sites=Ns_tmp[[1]]$sites,richness=Ns_tmp[[1]]$richness,sd=Ns_tmp[[1]]$sd,stringsAsFactors = F)
reps <- as.data.frame(Ns_tmp[[1]]$perm)
reps1 <- as.data.frame(reps[seq(1, nrow(reps), 1),])
reps1 <- reps1 %>%
mutate(sites=seq(1, nrow(reps), 1)) %>%
select(sites,everything()) %>%
gather(key="rep",value = "richness",-sites)
#plotting data
bmrbl_plot2 <- ggplot(df,aes(x=sites,y=richness))+
theme_classic()+
geom_ribbon(aes(ymin=richness-sd,ymax=richness+sd),fill="lightgrey")+
geom_line()+
geom_boxplot(data = reps1,aes(group=sites),outlier.shape = NA)+
geom_hline(yintercept=Ns_tmp[[2]]$chao)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$chao), aes(x, y), label=paste("Chao estimate = ",round(Ns_tmp[[2]]$chao,digits = 2)),hjust=0, vjust=-1.5)+
geom_hline(yintercept=Ns_tmp[[2]]$jack1)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$jack1), aes(x, y), label=paste("Jackknife estimate = ",round(Ns_tmp[[2]]$jack1,digits = 2)),hjust=0, vjust=1.5)+
ylim(0,30)+
xlab("Number of offspring sampled")+
ylab("Number of parent genotypes")+
ggtitle("B) Lower Black Mallard - 2016")
bmrbl_plot2
#plotting data
bmrbl_plot2 <- ggplot(df,aes(x=sites,y=richness))+
theme_classic()+
geom_ribbon(aes(ymin=richness-sd,ymax=richness+sd),fill="lightgrey")+
geom_line()+
geom_boxplot(data = reps1,aes(group=sites),outlier.shape = NA)+
geom_hline(yintercept=Ns_tmp[[2]]$chao)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$chao), aes(x, y), label=paste("Chao estimate = ",round(Ns_tmp[[2]]$chao,digits = 2)),hjust=0, vjust=1.5)+
geom_hline(yintercept=Ns_tmp[[2]]$jack1)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$jack1), aes(x, y), label=paste("Jackknife estimate = ",round(Ns_tmp[[2]]$jack1,digits = 2)),hjust=0, vjust=-1.5)+
ylim(0,30)+
xlab("Number of offspring sampled")+
ylab("Number of parent genotypes")+
ggtitle("B) Lower Black Mallard - 2016")
bmrbl_plot2
#plotting data
bmrbl_plot2 <- ggplot(df,aes(x=sites,y=richness))+
theme_classic()+
geom_ribbon(aes(ymin=richness-sd,ymax=richness+sd),fill="lightgrey")+
geom_line()+
geom_boxplot(data = reps1,aes(group=sites),outlier.shape = NA)+
geom_hline(yintercept=Ns_tmp[[2]]$chao)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$chao), aes(x, y), label=paste("Chao estimate = ",round(Ns_tmp[[2]]$chao,digits = 2)),hjust=0, vjust=1.5)+
geom_hline(yintercept=Ns_tmp[[2]]$jack1)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$jack1), aes(x, y), label=paste("Jackknife estimate = ",round(Ns_tmp[[2]]$jack1,digits = 2)),hjust=0, vjust=-1.5)+
ylim(0,30)+
xlab("Number of offspring sampled")+
ylab("Number of parent genotypes")+
ggtitle("B) Lower Black Mallard - 2016")
##chePR
Ns_tmp <- Ns_calc(subset(all_families,all_families$cohort == "chePR"))
#isolating data to plot
df <- data.frame(sites=Ns_tmp[[1]]$sites,richness=Ns_tmp[[1]]$richness,sd=Ns_tmp[[1]]$sd,stringsAsFactors = F)
reps <- as.data.frame(Ns_tmp[[1]]$perm)
reps1 <- as.data.frame(reps[seq(1, nrow(reps), 1),])
reps1 <- reps1 %>%
mutate(sites=seq(1, nrow(reps), 1)) %>%
select(sites,everything()) %>%
gather(key="rep",value = "richness",-sites)
#plotting data
che_plot <- ggplot(df,aes(x=sites,y=richness))+
theme_classic()+
geom_ribbon(aes(ymin=richness-sd,ymax=richness+sd),fill="lightgrey")+
geom_line()+
geom_boxplot(data = reps1,aes(group=sites),outlier.shape = NA)+
geom_hline(yintercept=Ns_tmp[[2]]$chao)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$chao), aes(x, y), label=paste("Chao estimate = ",round(Ns_tmp[[2]]$chao,digits = 2)),hjust=0, vjust=-1.5)+
geom_hline(yintercept=Ns_tmp[[2]]$jack1)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$jack1), aes(x, y), label=paste("Jackknife estimate = ",round(Ns_tmp[[2]]$jack1,digits = 2)),hjust=0, vjust=1.25)+
ylim(0,20)+
xlab("Number of offspring sampled")+
ylab("Number of parent genotypes")+
ggtitle("E) Pigeon River")
che_plot
#plotting data
che_plot <- ggplot(df,aes(x=sites,y=richness))+
theme_classic()+
geom_ribbon(aes(ymin=richness-sd,ymax=richness+sd),fill="lightgrey")+
geom_line()+
geom_boxplot(data = reps1,aes(group=sites),outlier.shape = NA)+
geom_hline(yintercept=Ns_tmp[[2]]$chao)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$chao), aes(x, y), label=paste("Chao estimate = ",round(Ns_tmp[[2]]$chao,digits = 2)),hjust=0, vjust=-1.5)+
geom_hline(yintercept=Ns_tmp[[2]]$jack1)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$jack1), aes(x, y), label=paste("Jackknife estimate = ",round(Ns_tmp[[2]]$jack1,digits = 2)),hjust=0, vjust=1.25)+
ylim(0,15)+
xlab("Number of offspring sampled")+
ylab("Number of parent genotypes")+
ggtitle("E) Pigeon River")
che_plot
##bmrAL
Ns_tmp <- Ns_calc(subset(all_families,all_families$cohort == "bmral"))
##bmrAL
Ns_tmp <- Ns_calc(subset(all_families,all_families$cohort == "bmrAL"))
#isolating data to plot
df <- data.frame(sites=Ns_tmp[[1]]$sites,richness=Ns_tmp[[1]]$richness,sd=Ns_tmp[[1]]$sd,stringsAsFactors = F)
reps <- as.data.frame(Ns_tmp[[1]]$perm)
reps1 <- as.data.frame(reps[seq(1, nrow(reps), 1),])
reps1 <- reps1 %>%
mutate(sites=seq(1, nrow(reps), 1)) %>%
select(sites,everything()) %>%
gather(key="rep",value = "richness",-sites)
#plotting data
bmral_plot <- ggplot(df,aes(x=sites,y=richness))+
theme_classic()+
geom_ribbon(aes(ymin=richness-sd,ymax=richness+sd),fill="lightgrey")+
geom_line()+
geom_boxplot(data = reps1,aes(group=sites),outlier.shape = NA)+
geom_hline(yintercept=Ns_tmp[[2]]$chao)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$chao), aes(x, y), label=paste("Chao estimate = ",round(Ns_tmp[[2]]$chao,digits = 2)),hjust=0, vjust=1.5)+
geom_hline(yintercept=Ns_tmp[[2]]$jack1)+
geom_text(data=data.frame(x=0,y=Ns_tmp[[2]]$jack1), aes(x, y), label=paste("Jackknife estimate = ",round(Ns_tmp[[2]]$jack1,digits = 2)),hjust=0, vjust=-1)+
ylim(0,20)+
xlab("Number of offspring sampled")+
ylab("Number of parent genotypes")+
ggtitle("C) Upper Black Mallard River")
bmral_plot
multiplot(bmrbl_plot1,bmrbl_plot2,bmral_plot,ocq_plot,che_plot,cols = 2)
tiff(filename = "Figures/Ns_extrapolation_plots.tiff",height = 10,width = 10,units = "in",res = 200)
multiplot(bmrbl_plot1,bmrbl_plot2,bmral_plot,ocq_plot,che_plot,cols = 2)
dev.off()
table(bmr$ClusterIndex)
table(ocq$ClusterIndex)
length(ocq$ClusterIndex)
354/389
length(ocq$full_sib)
table(ocq$full_sib)
table(ocq$MotherID)
table(ocq$FatherID)
184+167
351/394
table(che$full_sib)
#load libraries
library(tidyverse)
#load homebrew functions
source("Homebrew/multiplot.R")
#load best cluster data
bmr_clust <- read.table(file = "Software_outputs/BMR_Output.data.BestCluster",header = T, sep = "\t",stringsAsFactors = F)
ocq_clust <- read.table(file = "Software_outputs/OCQ_Output.data.BestCluster",header = T, sep = "\t",stringsAsFactors = F)
load("Aging_Models/Family_data_all_locations.rda")
all_families <- all_families %>% select(-FatherID:-ClusterIndex)
clust_all <- rbind(ocq_clust,bmr_clust)
clust_all1 <- all_families %>% full_join(clust_all,by = c("OffspringID"))
#Black Mallard
bmr1 <- clust_all1 %>%
filter(samp == "BMR_2017" | samp == "BMR_2018")
collect.labs <- c("2017 Collection","2018 Collection")
names(collect.labs) <- c("BMR_2017", "BMR_2018")
bmr_plot <- ggplot(bmr1,aes(x=ClusterIndex,group=ClusterIndex,y=Length,fill=Probability))+
facet_wrap(vars(samp),labeller =labeller(samp=collect.labs))+
geom_boxplot(alpha=0.3)+
theme_bw()+
scale_fill_gradient(low="red", high="white",name = "Cluster \nLikelihood")+
xlab("Family Cluster")+
ylab("Length (mm)")+
ggtitle("A) Downstream Black Mallard River")
#Ocqueoc
ocq1 <- clust_all1 %>%
filter(loc == "OCQ")
bmr_plot <- ggplot(bmr1,aes(x=ClusterIndex,group=ClusterIndex,y=Length,fill=Probability))+
facet_wrap(vars(samp),labeller =labeller(samp=collect.labs))+
geom_boxplot(alpha=0.3)+
theme_bw()+
scale_fill_gradient(low="red", high="white",name = "Cluster \nLikelihood")+
xlab("Family Cluster")+
ylab("Length (mm)")+
ggtitle("A) Lower Black Mallard River")
#Ocqueoc
ocq1 <- clust_all1 %>%
filter(loc == "OCQ")
collect.labs <- c("2018 Collection")
names(collect.labs) <- c("OCQ_2018")
ocq_plot <- ggplot(ocq1,aes(x=ClusterIndex,group=ClusterIndex,y=Length,fill=Probability))+
facet_wrap(vars(samp),labeller =labeller(samp=collect.labs))+
geom_boxplot(alpha=0.3)+
theme_bw()+
scale_fill_gradient(low="red", high="white",name = "Cluster \n Likelihood")+
xlab("Cluster")+
ylab("Length (mm)")+
ggtitle("B) Ocqueoc River")
#putting plots together
tiff(filename = "Figures/Length_Boxplots_prob.tiff",height = 10,width = 10,units = "in",res = 200)
multiplot(cols = 1,bmr_plot,ocq_plot)
dev.off()
#putting plots together
tiff(filename = "Figures/Length_Boxplots_prob.tiff",height = 8,width = 8,units = "in",res = 200)
multiplot(cols = 1,bmr_plot,ocq_plot)
dev.off()
#setwd
setwd("~/OneDrive - Michigan State University/Documents/Sea_Lamprey_MS_project/exp_bioinformatics/Figures_Tables/")
#libraries
library(tidyverse)
library(sp)
library(sf)
library(rnaturalearth)
library(rgdal)
library(rgeos)
library(ggrepel)
library(cowplot)
#load data
df <- read.csv(file = "site_coordinates.csv")
#getting lake, river and state shapes
points_sf <- st_as_sf(df, coords = c("Long", "Lat"), crs = 4326)
lakes110 <- ne_download(scale = 110, type = 'lakes', category = 'physical', returnclass = 'sf')
statesus <- ne_states(country = 'united states of america', returnclass = 'sf')
statescan <- ne_states(country = 'canada', returnclass = 'sf')
#putting data into proper sf format
points_sf <- st_as_sf(df, coords = c("Long", "Lat"), crs = 4326)
points_sf <- cbind(points_sf,chYear_collect = as.character(df$Year_collect))
class(points_sf)
rnaturalearth::ne_states(geounit = "australia", returnclass = "sf")
#selecting specific lakes, states and provedences for map
lakes <- lakes110 %>%
filter(name_alt == "Great Lakes") %>%
#select(name) %>%
st_transform(crs = "+proj=longlat +datum=WGS84")
USstates <- statesus %>%
#select(name) %>%
st_transform(crs = "+proj=longlat +datum=WGS84")
CANprov <- statescan %>%
#filter(name %in% c('Ontario')) %>%
select(name) %>%
st_transform(crs = "+proj=longlat +datum=WGS84")
#map plot
ggplot()+
geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = points_sf,
show.legend = "point",
size = 2)+
scale_fill_discrete(c("blue","light blue"))+
coord_sf(xlim = c(-94, -74), ylim = c(40, 49), expand = FALSE)+
theme_bw()+
theme(panel.grid = element_blank())+
labs(color = "Collection \nType",shape = "Year \nCollected")
#map plot
ggplot()+
geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = points_sf,
show.legend = "point",
size = 2)+
scale_fill_discrete(c("blue","light blue"))+
coord_sf(xlim = c(-94, -74), ylim = c(40, 49), expand = FALSE)+
theme_bw()+
theme(panel.grid = element_blank())+
labs(color = "Collection \nType",shape = "Year \nCollected")
#making a new plot with just the expansion location
#selecting specific lakes, states and provedences for map
lakes2 <- lakes110 %>%
filter(name_alt == "Great Lakes") %>%
st_transform(crs = "+proj=longlat +datum=WGS84") %>%
filter(name %in% c('Lake Michigan','Lake Huron'))
USstates2 <- statesus %>%
#select(name) %>%
st_transform(crs = "+proj=longlat +datum=WGS84") %>%
filter(name %in% c('Michigan'))
points_sf2 <- points_sf %>%
filter(Type == "Barrier")
inset <- ggplot()+
geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = points_sf2,
aes(color = Type, shape=chYear_collect),
size = 2, color = "black")+
coord_sf(xlim = c(-91, -79), ylim = c(41.5, 47.6), expand = FALSE)+
geom_rect(aes(xmin=-84.7,xmax=-83.5,ymin=45,ymax=46),
fill="transparent",color = "black")+
theme_classic()+
theme(legend.position = "none",
axis.text.x = element_text(angle = 90))
#creating a smaller map with just the study locations (zoomed in)
#adding river shape files
river_shapes <- st_read(dsn = "USA_Rivers_and_Streams-shp/")
lake_shapes <- st_read(dsn = "USA_Detailed_Water_Bodies/")
#BMR: 56604
bmr <- river_shapes %>% filter(OBJECTID==56604)
bmr$Name <- as.factor("Black Mallard River")
#BMR Lake: 294985
bmr_lake <- lake_shapes %>% filter(OBJECTID==294985)
#CHE:
che <- river_shapes %>% filter(OBJECTID==58322)
#OCQ: 58137, 58508,58561
ocq <- river_shapes %>% filter(OBJECTID==58137|OBJECTID==58508|OBJECTID==58561)
river_shapes %>% filter(Name == "Ocqueoc River")
#OCQ Lake: 22370
ocq_lake <- lake_shapes %>% filter(OBJECTID==22370)
rivers <- rbind(bmr,che,ocq)
#MI Rivers
MI_rivers <- river_shapes %>% filter(State=="MI")
MI_lakes <- lake_shapes %>% filter(State=="MI")
p2 <- ggplot()+
#geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = MI_rivers, col = "lightblue")+
geom_sf(data = rivers,col = "black")+
geom_sf(data = bmr_lake, col = "black")+
geom_sf(data = ocq_lake, col = "white")+
coord_sf(xlim = c(-84.7, -83.5), ylim = c(45, 46), expand = FALSE)+
theme_classic()
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
#OCQ: 58137, 58508,58561
ocq <- river_shapes %>% filter(OBJECTID==58137|OBJECTID==58508)
river_shapes %>% filter(Name == "Ocqueoc River")
#OCQ Lake: 22370
ocq_lake <- lake_shapes %>% filter(OBJECTID==22370)
p2 <- ggplot()+
#geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = MI_rivers, col = "lightblue")+
geom_sf(data = rivers,col = "black")+
geom_sf(data = bmr_lake, col = "black")+
geom_sf(data = ocq_lake, col = "white")+
coord_sf(xlim = c(-84.7, -83.5), ylim = c(45, 46), expand = FALSE)+
theme_classic()
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
river_shapes %>% filter(Name == "Ocqueoc River")
#OCQ: 58137, 58508,58561
ocq <- river_shapes %>% filter(OBJECTID==58508|OBJECTID==58561)
p2 <- ggplot()+
#geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = MI_rivers, col = "lightblue")+
geom_sf(data = rivers,col = "black")+
geom_sf(data = bmr_lake, col = "black")+
geom_sf(data = ocq_lake, col = "white")+
coord_sf(xlim = c(-84.7, -83.5), ylim = c(45, 46), expand = FALSE)+
theme_classic()
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
#MI Rivers
MI_rivers <- river_shapes %>% filter(State=="MI")
p2 <- ggplot()+
#geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = MI_rivers, col = "lightblue")+
geom_sf(data = rivers,col = "black")+
geom_sf(data = bmr_lake, col = "black")+
geom_sf(data = ocq_lake, col = "white")+
coord_sf(xlim = c(-84.7, -83.5), ylim = c(45, 46), expand = FALSE)+
theme_classic()
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
rivers <- rbind(bmr,che,ocq)
p2 <- ggplot()+
#geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = MI_rivers, col = "lightblue")+
geom_sf(data = rivers,col = "black")+
geom_sf(data = bmr_lake, col = "black")+
geom_sf(data = ocq_lake, col = "white")+
coord_sf(xlim = c(-84.7, -83.5), ylim = c(45, 46), expand = FALSE)+
theme_classic()
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
#OCQ: 58137, 58508,58561
ocq <- river_shapes %>% filter(OBJECTID==58137)
river_shapes %>% filter(Name == "Ocqueoc River")
rivers <- rbind(bmr,che,ocq)
p2 <- ggplot()+
#geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = MI_rivers, col = "lightblue")+
geom_sf(data = rivers,col = "black")+
geom_sf(data = bmr_lake, col = "black")+
geom_sf(data = ocq_lake, col = "white")+
coord_sf(xlim = c(-84.7, -83.5), ylim = c(45, 46), expand = FALSE)+
theme_classic()
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
river_shapes %>% filter(Name == "Silver Creek")
#OCQ: 58137, 58508,58561
ocq <- river_shapes %>% filter(OBJECTID==58137|OBJECTID==25790)
rivers <- rbind(bmr,che,ocq)
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
p2 <- ggplot()+
#geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = MI_rivers, col = "lightblue")+
geom_sf(data = rivers,col = "black")+
geom_sf(data = bmr_lake, col = "black")+
geom_sf(data = ocq_lake, col = "white")+
coord_sf(xlim = c(-84.7, -83.5), ylim = c(45, 46), expand = FALSE)+
theme_classic()
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
river_shapes %>% filter(Name == "Silver Creek")
river_shapes %>% filter(Name == "Silver Creek"| Feature == "Stream"| State == "MI")
river_shapes %>% filter(Name == "Silver Creek" & Feature == "Stream" & State == "MI")
#OCQ: 58137, 58508,58561
ocq <- river_shapes %>% filter(OBJECTID==58137|OBJECTID==58443)
rivers <- rbind(bmr,che,ocq)
p2 <- ggplot()+
#geom_sf(data = lakes, fill = "white")+
geom_sf(data = USstates)+
geom_sf(data = CANprov)+
geom_sf(data = MI_rivers, col = "lightblue")+
geom_sf(data = rivers,col = "black")+
geom_sf(data = bmr_lake, col = "black")+
geom_sf(data = ocq_lake, col = "white")+
coord_sf(xlim = c(-84.7, -83.5), ylim = c(45, 46), expand = FALSE)+
theme_classic()
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
M
M
M
tiff(filename = "StudyMap.tiff",height = 6,width = 5,units = "in",res = 200)
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.45,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
dev.off()
tiff(filename = "StudyMap.tiff",height = 6,width = 5,units = "in",res = 200)
ggdraw()+
draw_plot(p2)+
draw_plot(inset,x = 0.50, y = 0.55, width = 0.5, height = 0.5)+
draw_plot_label(label = "Black \nMallard",x=0.37,y=0.57,size = 8)+
draw_plot_label(label = "Ocqueoc",x=0.55,y=0.43,size = 8)+
draw_plot_label(label = "Pigeon",x=0.2,y=0.45,size = 8)
dev.off()
#loading libraries
library(tidyverse)
library(bayesmix)
library(bmixture)
#load in length and weight data
df <- read.table("AgingModels/lw_2019_locations_081220.txt",header = T,sep = "\t",stringsAsFactors = F)
